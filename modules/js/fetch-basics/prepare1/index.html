<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fetch Basics - What is AJAX and Fetch?</title>
    <meta name="description" content="Getting started with making asynchronous requests with Fetch">
    <link rel="apple-touch-icon" sizes="180x180" href="/learning-modules/img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/learning-modules/img/favicon/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/learning-modules/img/favicon/favicon-16x16.png" sizes="16x16">
    <link rel="shortcut icon" href="/learning-modules/img/favicon/favicon.ico">
    <link rel="stylesheet" href="/learning-modules/css/index.css">
    <link rel="stylesheet" href="/learning-modules/css/prism-coy.css">
    <link rel="alternate" href="/learning-modules/feed/feed.xml" type="application/atom+xml" title="WDD Learning Modules">
    <link rel="alternate" href="/learning-modules/feed/feed.json" type="application/json" title="WDD Learning Modules">
  </head>
  <body>
    <header>
      <div class="branding">
        <a href="/learning-modules/">
          <img src="/learning-modules/img/TwoLineMonogram_white.svg" alt="BYU-I logo" class="logo">
        </a>
        <h1 class="vertical-text">WDD Learning Modules</h1>
      </div>
      <nav>
        <ul class="nav">
            <li class="nav-item">
              <a href="/learning-modules/">Home</a>
            </li>
            <li class="nav-item">
              <a href="/learning-modules/modules/html/">HTML</a>
            </li>
            <li class="nav-item">
              <a href="/learning-modules/modules/js/">JS</a>
            </li>
            <li class="nav-item">
              <a href="/learning-modules/modules/css/">CSS</a>
            </li>
            <li class="nav-item">
              <a href="/learning-modules/modules/design/">Design</a>
            </li>
            <li class="nav-item">
              <a href="/learning-modules/modules/general/">General</a>
            </li>
        </ul>
      </nav>
    </header>
    <main  class="tmpl-post" >
      
<h1>Fetch Basics - What is AJAX and Fetch?</h1>




<h2 id="ajax:-asynchronous-requests" tabindex="-1">AJAX: asynchronous requests <a class="direct-link" href="#ajax:-asynchronous-requests" aria-hidden="true">#</a></h2>
<p><strong>AJAX</strong> stands for Asynchronous Javascript And Xml. It is a collection of technologies that allow a webpage to make a request to a server after it has loaded for additional information. The requests are Asynchronous in that the program the made them does not wait around doing nothing until they come back...it will move on and do more stuff, the requests are made with Javascript, but they don't often return XML anymore. Most often now you will get the information back as JSON.</p>
<p>Originally the requests were made using <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest">XmlHttpRequest</a>, and you will still see that around, but more and more developers are turning to the newer <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch">fetch</a> api to make their requests.</p>
<h2 id="promises" tabindex="-1">Promises <a class="direct-link" href="#promises" aria-hidden="true">#</a></h2>
<p>The asynchronous nature of these requests is a blessing and a curse. A blessing because the developer has no control over how quickly or slowly the server responds. So if the request was made synchronously nothing else could happen until the request finished. If the server you are waiting for is slow, it will make your application slow...not good. So asynchronous requests allow our code to interact with external sources while still being performant.</p>
<p>Asynchronous programming is a bit different to work with however. You have to deal with the fact that your code might not run in the order you wrote it. This is the curse. There are two main ways for dealing with this. One we have talked about before...callback functions. They have been used for a while now, but often lead to code that is really hard to follow...<a href="http://callbackhell.com/">callback hell</a> is what it is often called.</p>
<p>The newer method for writing asynchronous code is <strong>Promises</strong>. Promises essentially give us another way to say &quot;when you finish your thing...<code>then</code> do this next thing&quot;. The best way to understand them is by seeing them in practice. Luckily for us fetch uses promises.</p>
<h2 id="example" tabindex="-1">Example <a class="direct-link" href="#example" aria-hidden="true">#</a></h2>
<p>We will use fetch to pull some data from a remote API (application programming interface). An API is essentially what happens when an organization decides to expose part of a program they own to the world. Why would they do this? Well let's take Calendly for example. It is an online scheduling application. A student can go sign up for an appointment with their instructor easily with it. The University uses Microsoft Exchange for calendaring. If something doesn't show up there...I will miss it. Luckily Exchange has an API. Through this API Calendly can log into my Exchange account and add things directly to my calendar if I give it permission to.</p>
<p>So as soon as a student signs up for an appointment in Calendly, the appointment automatically gets added to my calendar. This is one example of when an API is very useful.</p>
<p>We are going to use a fairly simple free API called <a href="https://pokeapi.co/">pokeapi</a>. If you visit that website you will find the documentation on how to request data, and examples. Let's use the example it has to pull information about the Pokemon Ditto.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">'https://pokeapi.co/api/v2/pokemon/ditto'</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">;</span>'</code></pre>
<p>There is a lot going on in that simple line of code. With it we made a request for some specific information from a remote server. Check the console and you will find however that we did not get the information yet. Just as was mentioned above fetch returns a Promise. By default Javascript will not wait for a Promise to finish before it moves on to the next line. This can cause big problems if the next line needs the results of the Promise to do it's job. Take the following example:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">"https://pokeapi.co/api/v2/pokemon/ditto"</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">doStuff</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Javascript would run the line with fetch. Results would get set to a Promise initially. Then the execution would move immediately on to the line <code>doStuff(results)</code> The problem is that our function expects <strong>results</strong> to be the data NOT a Promise! It won't work. We need a way to delay the execution of <code>doStuff(results)</code> UNTIL fetch finishes and the Promise resolves.</p>
<p>The easiest way to do that is with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">async/await</a>. Though it can also be done with the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then">.then()</a> method, Async/await code is more readable in general and easier to follow so we will use that method.</p>
<p>So how do we use async/await? First, async/await <strong>can only be used in functions</strong>. This is very important. We must first declare a function as an asynchronous function with the <code>async</code> keyword, then put our code inside of that. This is not a big drawback since we really should have put this in a function anyway ;)</p>
<p>Once we have done that we can instruct Javascript to delay moving to the next line by using the <code>await</code> keyword. With the example above it would look like this:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">"https://pokeapi.co/api/v2/pokemon/ditto"</span><span class="token punctuation">;</span><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getPokemon</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token function">doStuff</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">getPokemon</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>We are getting closer, but our example is still not complete. It turns out that <code>fetch</code> does not return usable data initially. It returns what is known as a data stream. We have to tell fetch what we were expecting...and ask it to convert the response into the right kind of data. The three types it understands are <code>json()</code>, <code>text()</code> (HTML and XML would be considered text), and <code>blob()</code> (blob is anything that isn't text or json). We are expecting JSON back from the api we made the request to. So we should convert it to that.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">"https://pokeapi.co/api/v2/pokemon/ditto"</span><span class="token punctuation">;</span><br><span class="token keyword">let</span> results <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getPokemon</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">//check to see if the fetch was successful</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// the API will send us JSON...but we have to convert the response before we can use it</span><br>    <span class="token comment">// .json() also returns a promise...so we await it as well.</span><br>    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">doStuff</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><span class="token keyword">function</span> <span class="token function">doStuff</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  results <span class="token operator">=</span> data<span class="token punctuation">;</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"first: "</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token function">getPokemon</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"second: "</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Run the code above then check out the console. Note that the second console.log ran first...then the first one. Remember that in async programming Javascript does not wait for everything to finish before moving on. If we had tried to use <code>results</code> immediately it would have failed. Instead we control the execution of functions to make sure that <code>results</code> is ready BEFORE we use it.</p>

</main>
    <footer>
      <p class="license">
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"/> </a><br/>This work is licensed under a
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0
          International License</a>.</p>
    </footer><!-- Current page: /learning-modules/modules/js/fetch-basics/prepare1/ --></body>
</html>